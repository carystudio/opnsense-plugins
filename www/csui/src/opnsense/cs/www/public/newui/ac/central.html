<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Carystudio</title>
    <link rel="stylesheet" href="/newui/plugin/iview/styles/iview.css">
    <link rel="stylesheet" href="/newui/static/css/style.css">
</head>
<body>
<div id="app"></div>

<script type="text/x-template" id="main">
    <Col class="cs-container" span="20" >
    <slot name="breadcrumb" :breadcrumb="[$t('menu.ac'),$t('menu.central')]"></slot>
    <!-- 这个不能删除，用于面包屑显示 -->
    <div class="cs-content">
        <Row>
            <Col :xs="globalConfig.xs">
            <Card>
                <Alert>
                    {{ $t('central.help') }}
                </Alert>
                <Row>
                    <Col>
                    <Button type="primary" :loading="apscanLoading" @click="apscanClick">{{ $t('central.apscan') }}</Button>
                    <Button type="primary" @click="setinfoClick">{{ $t('central.setinfo') }}</Button>
                    <Button type="primary" @click="letctlClick">{{ $t('central.letctl') }}</Button>
                    <Button type="primary" @click="timingRebootClick(true)">{{ $t('central.unified_change_ip') }}</Button>
                    <Button type="primary" @click="rebootClick">{{ $t('central.reboot') }}</Button>
                    <Button type="primary" @click="showModel=true">{{ $t('central.restore') }}</Button>
                    <Tooltip trigger="hover" placement="top" :disabled="!usbState">
                        <Button type="primary" @click="uploadClick" >{{ $t('central.firmware_manage') }}</Button>
                        <div slot="content" style="white-space: normal;"> {{ $t('central.firmware_manage') }} </div>
                    </Tooltip>
                    <Button type="primary" @click="firmwareClick">{{ $t('central.firmware') }}</Button>
                    </Col>
                    <br>
                    <Row>
                        <Col>
                        <Table border ref="tableSelect" :columns="centralColumns" :data="centralData" @on-selection-change="centralTable" :no-data-text="$t('common.no_data')"></Table>
                        </Col>
                    </Row>
                </Row>
            </Card>
            </Col>
        </Row>
    </div>
    <Modal
            v-model="showModel"
            :title="$t('central.restore_set_title')"
            @on-ok="ok"
            @on-cancel="cancel"
            :ok-text="$t('common.ok')"
            :cancel-text="$t('common.cancel')"
            >
        <span>{{$t('central.msg20')}}</span>
    </Modal>
    <Modal
            v-model="setinfo"
            :title="$t('central.setinfo')"
            :closable="false"
            :mask-closable="false"
    >
        <Form ref="formSetinfo" :model="formSetinfo" :rules="ruleSetinfo" :label-width="120" label-position="left">
            <FormItem :label="$t('central.apname')" v-if="multipleHide" prop="apname">
                <Input v-model="formSetinfo.apname" ></Input>
            </FormItem>
            <!--定时重启-->
            <FormItem :label="$t('central.reboot_mode')">
                <Select v-model="rebootmode">
                    <Option value="0">{{ $t('central.disable') }}</Option>
                    <Option value="1">{{ $t('central.timing_reboot') }}</Option>
                    <Option value="2">{{ $t('central.reboot_countdown') }}</Option>
                </Select>
            </FormItem>
            <FormItem :label="$t('central.week')"  v-if="rebootmode == '1'">
                <Select v-model="formSetinfo.week">
                    <Option value="255">{{ $t('central.all') }}</Option>
                    <Option value="128">{{ $t('central.sun') }}</Option>
                    <Option value="2">{{ $t('central.mon') }}</Option>
                    <Option value="4">{{ $t('central.tue') }}</Option>
                    <Option value="8">{{ $t('central.wed') }}</Option>
                    <Option value="16">{{ $t('central.thu') }}</Option>
                    <Option value="32">{{ $t('central.fri') }}</Option>
                    <Option value="64">{{ $t('central.sat') }}</Option>
                </Select>
            </FormItem>
            <FormItem :label="$t('central.time')"  v-if="rebootmode == '1'">
                <row>
                    <Col span="6">
                    <Select  v-model="formSetinfo.time[0]">
                        <Option v-for="(i,v) in 24" :key="i" :value="v">{{v}}</Option>
                    </Select>
                    </Col>
                    <Col span="2">&nbsp;&nbsp;&nbsp;:</Col>
                    <Col span="6">
                    <Select  v-model="formSetinfo.time[1]">
                        <Option v-for="(i,v) in 60" :key="i" :value="v">{{v}}</Option>
                    </Select>
                    </Col>
                    <Col span="7"><Span>{{$t('central.times')}}</Span></Col>
                </row>
            </FormItem>
            <FormItem :label="$t('central.reboot_countdown')" prop="timedown" v-if="rebootmode == '2'">
                <row>
                    <Col span="8">
                    <Input v-model="formSetinfo.timedown"></Input>
                    </Col>
                    <Col span="8">
                    <Span>{{$t('central.hour')}}</Span>
                    </Col>
                </row>
            </FormItem>
            <!--定时重启END-->
            <FormItem :label="$t('central.wlan_set')" prop="wlanset">
                <Select v-model="wlanset" :disabled="getWlanState">
                    <Option value="1">2.4G</Option>
                    <Option value="2">5G</Option>
                </Select>
            </FormItem>
            <FormItem :label="$t('central.ssid')" prop="ssid">
                <Input v-model="formSetinfo.ssid" ></Input>
            </FormItem>
            <FormItem :label="$t('central.security')" >
                <i-switch v-model="securityMode" size="large" >
                    <span slot="open">{{$t('central.encryption')}}</span>
                    <span slot="close">{{$t('central.unencrypted')}}</span>
                </i-switch>
                </Input>
            </FormItem>
            <FormItem :label="$t('central.password')" prop="security"  v-show="formSetinfo.securityMode == '1'" >
                <Input v-model="formSetinfo.security"></Input>
            </FormItem>

            <div v-show="wlanset == '1'">
                <FormItem :label="$t('central.band2')" prop="band2">
                    <Select v-model="formSetinfo.band2">
                        <Option value="1">2.4 GHz (B)</Option>
                        <Option value="4">2.4 GHz (G)</Option>
                        <Option value="6">2.4 GHz (N)</Option>
                        <Option value="9">2.4 GHz (B+G+N)</Option>
                    </Select>
                </FormItem>
                <FormItem :label="$t('central.channels')" prop="channel2">
                    <Select v-model="formSetinfo.channel2" :key="$t('central.channels')" placement="top">
                        <Option value="0">{{ $t('central.auto_select') }}</Option>
                        <Option v-for="i in 13" :key="i" :value="i">{{ i }}</Option>
                    </Select>
                </FormItem>
                <FormItem :label="$t('central.bandwidth2')" prop="band_width2">
                    <Select v-model="formSetinfo.band_width2">
                        <Option value="0">20M</Option>
                        <Option value="1">20M/40M</Option>
                    </Select>
                </FormItem>
                <FormItem :label="$t('central.tx_powers')" prop="tx_power2">
                    <Select v-model="formSetinfo.tx_power2" placement="top">
                        <Option v-for="i in txPower" :key="i" :value="i">{{ i+'%' }}</Option>
                    </Select>
                </FormItem>
                <FormItem v-show="false" :label="$t('central.beacon')" prop="beacon2g">
                    <Input v-model="formSetinfo.beacon2g"  style="width: 80px"></Input>
                    <span> ({{$t('central.range')}} 20 - 999,{{$t('central.default')}} 100)</span>
                </FormItem>
            </div>
            <div v-show="wlanset == '2'">
                <FormItem :label="$t('central.band5')" prop="band5">
                    <Select v-model="band5">
                        <Option value="2">802.11A</Option>
                        <Option value="8">802.11A/N</Option>
                        <Option value="14">802.11A/N/AC</Option>
                    </Select>
                </FormItem>
                <FormItem :label="$t('central.channels')" prop="channel5">
                      <Select v-model="formSetinfo.channel5" :key="$t('central.channels')" placement="top">
                          <Option value="0">{{ $t('central.auto_select') }}</Option>
                          <Option v-for="i in channel5Arr" :key="i" :value="i">{{ i }}</Option>
                          <Option v-show="channelsStatus165" value="165">165</Option>
                      </Select>
                  </FormItem>
                <FormItem :label="$t('central.bandwidth5')" prop="band_width5">
                    <Select v-model="band_width5">
                        <Option value="0">20M</Option>
                        <Option value="1">20M/40M</Option>
                        <Option value="2">80M</Option>
                    </Select>
                </FormItem>
                <FormItem :label="$t('central.tx_powers')" prop="tx_power5">
                    <Select v-model="formSetinfo.tx_power5" placement="top">
                        <Option v-for="i in txPower" :key="i" :value="i">{{ i+'%'}}</Option>
                    </Select>
                </FormItem>
                <FormItem v-show="false" :label="$t('central.beacon')" prop="beacon5g">
                    <Input v-model="formSetinfo.beacon5g"  style="width: 80px"></Input>
                    <span> ({{$t('central.range')}} 20 - 999,{{$t('central.default')}} 100)</span>
                </FormItem>
            </div>

            <FormItem :label="$t('central.broad_ssid')" prop="hidessid">
                <i-switch v-model="formSetinfo.hidessid" size="large" >
                    <span slot="open">{{ $t('central.enabled') }}</span>
                    <span slot="close">{{ $t('central.disable') }}</span>
                </i-switch>
            </FormItem>
            <FormItem :label="$t('central.isolation')" prop="wifi_quarantine">
                <i-switch v-model="formSetinfo.wifi_quarantine" size="large" >
                    <span slot="open">{{ $t('central.enabled') }}</span>
                    <span slot="close">{{ $t('central.disable') }}</span>
                </i-switch>
            </FormItem>
            <FormItem :label="$t('central.max_num')" prop="maxusernumber">
                <Input v-model="formSetinfo.maxusernumber"  style="width: 80px"></Input>
                <span>({{$t('central.default_value')}}: 32)</span>
            </FormItem>
            <FormItem :label="$t('central.vlan_mark')" prop="vlanid">
                <Input v-model="formSetinfo.vlanid"  style="width: 80px"></Input>
                <span> ({{$t('central.range')}} 0 - 4094,{{$t('central.default')}} 0)</span>
            </FormItem>
        </Form>
        <div slot="footer">
            <Button type="text" @click="setinfo=false">{{ $t('common.cancel') }}</Button>
            <Button type="primary" @click="setinfoOk">{{ $t('common.apply') }}</Button>
        </div>
    </Modal>
    <Modal
            v-model="letctl"
            :title="$t('central.letctl')"
    >
        <Alert>
            {{ $t('central.ledctl_tip') }}
        </Alert>
        <Form :label-width="120" label-position="left">
            <FormItem>
                <Button type="primary" @click="letctlOk(2)">{{ $t('central.open') }}</Button>
                <Button type="primary" @click="letctlOk(1)">{{ $t('central.finish') }}</Button>
            </FormItem>
        </Form>
        <div slot="footer">
        </div>
    </Modal>
    <Modal
            v-model="uploads"
            :title="$t('central.firmware_manage')"
    >
        <Form :label-width="120" label-position="left">
            <FormItem :label="$t('central.upload')">
                <!-- :max-size="upload.maxSize" -->
                <Upload
                        ref="upload"
                        :action="upload.action"
                        :data="upload.data"
                        :format="upload.format"
                        :on-format-error="formatError"
                        :before-upload="handleBeforeUpload"
                        :on-success="uploadSuccess"
                >
                    <Button icon="ios-cloud-upload-outline">{{ $t('central.select_file')+' & '+$t('central.file_upload')   }}</Button>
                </Upload>
            </FormItem>
            <br>
            <Row>
                <Col>
                <Table border :columns="columns" :data="firmData" :no-data-text="$t('common.no_data')" :loading="firmDataloading"></Table>
                </Col>
            </Row>
            <br>
        </Form>
        <div slot="footer">
        </div>
    </Modal>
    <!-- 这个不能删除，用于底部显示 -->
    <Row>
        <Col style="position: fixed;bottom: 0;" offset="5">
            <slot name="footer"></slot>
        </Col>
    </Row>
    </Col>
</script>
<script src="/newui/plugin/vue.js"></script>
<script src="/newui/plugin/vue-i18n.js"></script>
<script src="/newui/plugin/iview/iview.js"></script>
<script src="/newui/plugin/jquery-1.11.3.min.js"></script>
<script src="/newui/plugin/util.js"></script>
<script src="/newui/static/js/language.js"></script>
<script src="/newui/static/js/config.js"></script>
<script src="/newui/static/js/layout.js"></script>
<script src="/newui/static/js/common.js"></script>
<script src="/newui/static/js/topicurl.js"></script>
<script>
    var cs_main = {
        template: "#main",
        data: function() {
            var _this = this;
            return {
                globalConfig: globalConfig,
                applyLoading: false,
                apscanLoading: false,
                multipleHide: true,
                firmDataloading:false,
                centralData: [],
                usbState:true,
                setinfo:false,
                letctl:false,
                reboot: false,
                timingReboot: false,
                restore: false,
                uploads: false,
                firmware: false,
                txPower:['15','35','50','75','100'],
                selectData:[],
                apname:[],
                ledStateInfo:[],
                channel5Arr:['36','40','44','48','149','153','157','161'],

                ledStatus:false,
                wlanState:false,
                wlanset:'1',
                showModel:false,
                securityMode:false,
                channelsStatus165:false,
                band_width5:'2',
                band5:'14',
                letctlAuthpwd:'admin',
                timingRebootSelect:'',
                upload: {
                    file: null,
                    action: '/webapi',
                    format:['web'],
                    data:{
                        action:'setUploadFile'
                    }
                },
                columns:[
                    {
                        type: 'index',
                        width: 40,
                        align: 'center'
                    },{
                        title: this.$t('central.firmware_version'),
                        key: 'version',
                        align: 'center'
                    },{
                        title: this.$t('central.operation'),
                        key: 'action',
                        width: 95,
                        align: 'center',
                        render: function (h, params) {
                        return h('div', [
                            h('Poptip', {
                                props: {
                                    confirm: true,
                                    title: _this.$t('central.msg18'),
                                    "ok-text":_this.$t('common.ok'),
                                    "cancel-text":_this.$t('common.cancel')
                                },
                                on: {
                                    "on-ok": function(){
                                        var postData = {"action":"delApUpgradeFile","data":{"version":params.row.version}};
                                        uiPost.delApUpgradeFile(postData,function(){
                                            _this.$Message.success({content:_this.$t('account.msg11'),onClose:function(){
                                                location.href = location.href;
                                            }});
                                        });
                                    }
                                }
                            },
                        [
                            h('Button', {
                                props: {
                                    type: 'error',
                                    size: 'small'
                                }
                            }, _this.$t('localaccount.delete'))
                        ])
                ]);
            }
            }
            ],
                firmData:[],
                percent: 0,
                rebootmode:'0',
                wlanStatus:[]
            }
        },
        computed: {
            getWlanState:function () {
                if(this.wlanState){
                    return true;
                }else{
                    return false;
                }
            },
            formSetinfo:function () {
                return {
                    apname: '',
                    rebootmode:'0',
                    ssid: '',
                    authpwd: 'admin',
                    changePasswd: '',
                    ipaddr: '',
                    gateway: '',
                    dns: '',
                    country2g:"CN",
                    country5g:"CN",
                    security: '',
                    securityMode: '0',
                    hidessid:true,
                    wifi_quarantine:false,
                    maxusernumber:'32',
                    vlanid:'0',
                    band2:'9',
                    channel2: '0',
                    band_width2:'0',
                    tx_power2: '100',
                    beacon2g:'100',
                    band5:'14',
                    security5: '',
                    channel5: '0',
                    band_width5:'2',
                    tx_power5: '100',
                    beacon5g:'100',
                    other:[],

                    //reboot
                    week:'255',
                    time:[0,0],
                    timedown:'1'
                };
            },
            ruleSetinfo:function(){
                var _this = this;
                return {
                    apname: [{ validator: function(r, v, f) {
                        if (v.length == 0) {
                            f(_this.$t('central.msg4'));
                        }
                        if (v.length>32) {
                            f(_this.$t('central.msg6'));
                        }
                        f();
                    },
                        trigger: 'blur'
                    }],
                    ssid: [{ validator: function(r, v, f) {
                        var _s = cs.ssid(v);
                        if (0 == _s) {
                            f(_this.$t('central.msg7'));
                        }
                        f();
                    },
                        trigger: 'blur'
                    }],
                    authpwd: [{ validator: function(r, v, f) {
                        if (v == '') {
                            f(_this.$t('central.msg2'));
                        }
                        f();
                    },
                        trigger: 'blur'
                    }],
                    ipaddr:[
                        { validator:function(r, v, f) {
                            var _s = cs.ip(v);
                            if(0 == _s) {
                                f(_this.$t('central.ipaddr')+_this.$t('central.msg10'));
                            }else if(1 == _s) {
                                f(_this.$t('central.ipaddr')+_this.$t('central.msg14'));
                            }else if(2 == _s) {
                                f(_this.$t('central.ipaddr')+_this.$t('central.msg11'));
                            }else if(3 == _s) {
                                f(_this.$t('central.ipaddr')+_this.$t('central.msg12'));
                            }else if(4 == _s) {
                                f(_this.$t('central.ipaddr')+_this.$t('central.msg13'));
                            }else{
                                f();
                            }
                        },trigger: 'blur' }
                    ],
                    gateway:[
                        { validator:function(r, v, f) {
                            var _s = cs.ip(v);
                            if(0 == _s) {
                                f(_this.$t('central.default_gateway')+_this.$t('central.msg10'));
                            }else if(1 == _s) {
                                f(_this.$t('central.default_gateway')+_this.$t('central.msg14'));
                            }else if(2 == _s) {
                                f(_this.$t('central.default_gateway')+_this.$t('central.msg11'));
                            }else if(3 == _s) {
                                f(_this.$t('central.default_gateway')+_this.$t('central.msg12'));
                            }else if(4 == _s) {
                                f(_this.$t('central.default_gateway')+_this.$t('central.msg13'));
                            }else{
                                if(
                                        _this.formSetinfo.gateway.split('.')[0] != _this.formSetinfo.ipaddr.split('.')[0]
                                        || _this.formSetinfo.gateway.split('.')[1] != _this.formSetinfo.ipaddr.split('.')[1]
                                        || _this.formSetinfo.gateway.split('.')[2] != _this.formSetinfo.ipaddr.split('.')[2]
                                ){
                                    f(_this.$t('central.msg6'));
                                }
                                if(_this.formSetinfo.gateway == _this.formSetinfo.ipaddr){
                                    f(_this.$t('central.msg7'));
                                }
                                f();
                            }
                        },trigger: 'blur' }
                    ],
                    dns: [
                        { validator:function(r, v, f) {
                            var _s = cs.ip(v);
                            if(0 == _s) {
                                f('DNS'+_this.$t('central.msg10'));
                            }else if(1 == _s) {
                                f('DNS'+_this.$t('central.msg14'));
                            }else if(2 == _s) {
                                f('DNS'+_this.$t('central.msg11'));
                            }else if(3 == _s) {
                                f('DNS'+_this.$t('central.msg12'));
                            }else if(4 == _s) {
                                f('DNS'+_this.$t('central.msg13'));
                            }else{
                                f();
                            }
                        },trigger: 'blur' }
                    ]
                }
            },
            centralColumns: function() {
                var _this = this;
                var columns = [];
                columns.push({
                    type: 'expand',
                    width: 30,
                    render: function(h, params) {
                        if(!(params.row.apstate & (1<<8)) ){
                            return h('Row',[]);
                        }else{
                            var aptype = '2.4G';
                            if('1' == params.row.aptype){
                                aptype = '2.4G';
                            }else if('2' == params.row.aptype){
                                aptype = '5G';
                            }else{
                                aptype = '2.4G+5G';
                            }
                            var uptime = cs.formatDate(params.row.uptime,'yyyy-MM-dd hh:mm:ss');
                            return h('Row',[
                                h('Col',{props:{span:6}},[h('p',_this.$t('central.ipaddr') + ': ' + params.row.ipaddr )]),
                                h('Col',{props:{span:6}},[h('p',_this.$t('central.netmask') + ': '+ params.row.netmask )]),
                                h('Col',{props:{span:6}},[h('p',_this.$t('central.default_gateway') + ': ' + params.row.gateway )]),
                                h('Col',{props:{span:6}},[h('p','NDS: '+ params.row.pridns )]),
                                h('Col',{props:{span:24}},[h('br')]),
                                h('Col',{props:{span:6}},[h('p',_this.$t('central.product_mode') + ': '+ params.row.model )]),
                                h('Col',{props:{span:6}},[h('p',_this.$t('central.firmware_version') + ': ' + params.row.softver + '.' + params.row.svnnum )]),
                                h('Col',{props:{span:6}},[h('p',_this.$t('central.publish_time') + ': '+ params.row.builddate )]),
                                h('Col',{props:{span:6}},[h('p',_this.$t('central.online_time') + ': '+ uptime )]),
                                h('Col',{props:{span:24}},[h('br')]),
                                h('Col',{props:{span:6}},[h('p',_this.$t('central.ap_type') + ': '+ aptype )]),
                                h('Col',{props:{span:6}},[h('p',_this.$t('central.username') + ': ' + params.row.username )]),
                                h('Col',{props:{span:6}},[h('p',_this.$t('central.password') + ': '+ params.row.password )]),
                                h('Col',{props:{span:6}},[h('p',_this.$t('central.heartbeat') + ': '+ params.row.hftimes )])
                            ]);
                        }

                    }
                },{
                    type: 'selection',
                    key: 'id',
                    width: "60"
                }
                );
                if(_this.ledStatus){
                    columns.push({
                        title: this.$t('central.letctl'),
                        key: 'id',
                        width: "80",
                        align:"center",
                        render: function(h, params) {
                            console.log(params);
                            console.log(_this.ledStateInfo);
                            _this.ledStateInfo[params.index].color = _this.ledStateInfo[params.index].state == '2'? "#f50" : "#000";
                            return  h('Icon', {
                                style:{
                                    cursor: 'pointer',
                                    color: _this.ledStateInfo[params.index].color
                                },
                                props: {
                                    type: "ios-lightbulb-outline"
                                },
                                nativeOn: {
                                    click: function () {
                                        var data = {};
                                        data.id = params.row.id;


                                        if('2' == _this.ledStateInfo[params.index].state){
                                            _this.ledStateInfo[params.index].state = '1';
                                            _this.ledStateInfo[params.index].color = '#000';
                                            data.ledState = '1';
                                        }else{
                                            _this.ledStateInfo[params.index].state = '2';
                                            _this.ledStateInfo[params.index].color = '#f50';
                                            data.ledState = '2';
                                        }
                                        console.log(_this.ledStateInfo[params.index]);

                                        var postVar ={"action":"setApLedState","data":data};
                                        uiPost.setApLedState(postVar,function(data){
                                            if (9999 == data.rescode){
                                                cs.loginOut();
                                            }
                                            if (0 == data.rescode) {
                                                _this.$Message.success({content: _this.$t('central.set_success'), onClose: function () {
                                                    location.href = location.href;
                                                }
                                                });
                                            } else {
                                                _this.$Message.error({content:_this.$t('central.modify_fail')+_this.$t('errorcode.'+data.rescode),duration:5});
                                            }
                                        });
                                    }
                                }
                            });
                        }
                    })
                }
                columns.push({
                    title: this.$t('central.apname'),
                    key: 'apname',
                    sortable: true,
                    render: function(h, params) {
                        var name = _this.$t('central.unknown');
                        if (params.row.apname != '' && null != params.row.apname) {
                            name = params.row.apname;
                        }
                        if(!(params.row.apstate & (1<<8)) ){
                            if(name == _this.$t('central.unknown')){
                                return h('Input', {
                                    props: {
                                        disabled:"disabled",
                                        placeholder :name
                                    }
                                });
                            }else{
                                return h('Input', {
                                    props: {
                                        disabled:"disabled",
                                        value :name
                                    }
                                });
                            }
                        }else{
                            if(name == _this.$t('central.unknown')){
                                return h('Input', {
                                    props: {
                                        placeholder :name
                                    },
                                    on:{
                                        'on-change':function (e) {
                                            _this.apname[params.index] = e.target.value;
                                        }
                                    }
                                });
                            }else{
                                return h('Input', {
                                    props: {
                                        placeholder :_this.apname[params.index],
                                        value :_this.apname[params.index]
                                    },
                                    on:{
                                        'on-change':function (e) {
                                            _this.apname[params.index] = e.target.value;
                                        }
                                    }
                                });
                            }
                        }
                    }
                }, {
                    title: this.$t('central.macaddr'),
                    key: 'apmac',
                    sortable: true
                },{
                    title: this.$t('central.ipaddr'),
                    key: 'ipaddr',
                    sortable: true,
                    render: function(h, params) {
                        return h('a', {
                            attrs: {
                                href: 'http://' + params.row.ipaddr,
                                target: '_blank'
                            },
                            domProps: {
                                innerHTML: params.row.ipaddr
                            }
                        });
                    }
                }, {
                    title: this.$t('central.device_status'),
                    key: 'apstate',
                    sortable: true,
                    render: function(h, params) {
                        var apstatus = '';
                        if(!(params.row.apstate & (1<<8)) ) {
                            apstatus = _this.$t('central.no_same_segment');
                        }else if(params.row.apstatus == '0') {
                            apstatus = _this.$t('central.user_online');
                        }else if(params.row.apstatus == '2') {
                            apstatus = _this.$t('central.user_rebooting');
                        }else if(params.row.apstatus == '3') {
                            apstatus = _this.$t('central.user_updateing');
                        }else if(params.row.apstatus == '4') {
                            apstatus = _this.$t('central.user_configing');
                        }else if(params.row.apstatus == '5') {
                            apstatus = _this.$t('central.user_no_authority');
                        }else {
                            apstatus = _this.$t('central.user_offline');
                        }
                        return h('div',apstatus);
                    }
                },
                {
                    title: this.$t('central.operation'),
                    key: 'operation',
                    align: 'center',
                    render: function(h, params) {
                        if(!(params.row.apstate & (1<<8)) ){
                            return [
                                h('Button', {
                                    props: {
                                        type: 'primary',
                                        size: 'small'
                                    },
                                    on: {
                                        click:function () {
                                            var data = {};
                                            data.apmac = params.row.apmac;
                                            var postVar ={"action":"setApIp","data":data};
                                            uiPost.setApIp(postVar);
                                            var time = 12;
                                            _this.$Modal.success({
                                                loading:true,
                                                render: function(h) {
                                                    return h('div',[
                                                        _this.$t('common.loading'),
                                                        h('Progress',{
                                                            attrs:{ percent:_this.percent }
                                                        })
                                                    ])
                                                }
                                            });
                                            var percentTimer = setInterval(function(){
                                                if (_this.percent>=100) {
                                                    clearInterval(percentTimer);
                                                    location.href = location.href;
                                                }
                                                _this.percent++;
                                            },cs.getTimer(time));
                                        }
                                    }
                                }, _this.$t('central.unified_change_ip'))
                            ]
                        }else{
                            return [
                                h('Button',{
                                            props: {
                                                type: 'primary',
                                                size: 'small'
                                            },
                                            on: {
                                                click:function () {
                                                    var newapname = _this.apname[params.index];
                                                    var apname = params.row.apname;

                                                    if(!newapname ){
                                                        _this.$Message.error(_this.$t('central.msg8'));
                                                        return false;
                                                    }
                                                    if (newapname && apname == newapname) {
                                                        _this.$Message.error(_this.$t('central.msg9'));
                                                        return false;
                                                    }
                                                    var data = {};
                                                    data.apid = params.row.id;
                                                    data.apname = newapname;
                                                    var postVar = {"action":"setApName","data":data};
                                                    uiPost.setApName(postVar,function(data) {
                                                        if (9999 == data.rescode){
                                                            cs.loginOut();
                                                        }
                                                        if (0 == data.rescode) {
                                                            _this.$Message.success({content: _this.$t("central.modify_success"), onClose: function () {
                                                                location.href = location.href;
                                                            }
                                                            });
                                                        } else {
                                                            _this.$Message.error({content:_this.$t('central.modify_fail')+_this.$t('errorcode.'+data.rescode),duration:5});
                                                        }

                                                    });
                                                }
                                            }
                                        }, _this.$t("central.submit")
                                )]
                        }
                    }
                });
                return columns;
            }
        },
        created: function() {
            var _this = this;
            var data = {};
            data.type = "scan";
            var postVar = {"action":"scanAp","data":data};
            uiPost.scanAp(postVar,function(data){
                if (9999 == data.rescode){
                    cs.loginOut();
                }
                _this.centralData = data.data;
                _this.apscanLoading = false;
                for(var x in data.data){
                    if('2' == data.data[x].ledstate){
                        _this.ledStatus = true;
                        break;
                    }
                }
                for(var i in data.data){
                    _this.apname[i] = data.data[i].apname;
                    _this.ledStateInfo[i] = [];
                    if('2' == data.data[i].ledstate){
                        _this.ledStateInfo[i].state = "2";
                        _this.ledStateInfo[i].color = "#f50";
                    }else{
                        _this.ledStateInfo[i].state = "1";
                        _this.ledStateInfo[i].color = "#000";
                    }
                }
            });
        },
        watch:{
            wlanset:function () {
                var _this = this;

                var temp = this.selectData;
                if (temp.length == 1) {
                    var apInfo = _this.wlanStatus;
                    if ('1' == _this.wlanset) {
                        apInfo = _this.wlanStatus['APS2G'];
                    } else {
                        apInfo = _this.wlanStatus['APS5G'];
                    }

                    _this.formSetinfo.ssid = apInfo.ssid;

                    if ('0' == apInfo.encryption) {
                        _this.formSetinfo.securityMode = '0';
                        _this.securityMode = false;
                    } else {
                        _this.formSetinfo.securityMode = '1';
                        _this.securityMode = true;
                    }
                    _this.formSetinfo.security = apInfo.passphrase;
                    if ('0' == apInfo.hide) {
                        _this.formSetinfo.hidessid = true;
                    } else {
                        _this.formSetinfo.hidessid = false;
                    }
                    if ('0' == apInfo.isolate) {
                        _this.formSetinfo.wifi_quarantine = false;
                    } else {
                        _this.formSetinfo.wifi_quarantine = true;
                    }
                    _this.formSetinfo.maxusernumber = apInfo.stanum;
                    _this.formSetinfo.vlanid = apInfo.vlanid;
                }
            },
            securityMode:function () {
                if(this.securityMode){
                    this.formSetinfo.securityMode = '1';
                }else{
                    this.formSetinfo.securityMode = '0'
                }
            },
            band_width5:function () {
                var _this = this;
                _this.formSetinfo.band_width5 = _this.band_width5;
                if('0' == _this.band_width5 && '2' != _this.band5){
                    _this.channelsStatus165 = true;
                }else{
                    if('165' == _this.formSetinfo.channel5){
                        _this.formSetinfo.channel5 = '0';
                    }
                    _this.channelsStatus165 = false;
                }
            },
            band5:function () {
                var _this = this;
                _this.formSetinfo.band5 = _this.band5;
                if('0' == _this.band_width5 && '2' != _this.band5){
                    _this.channelsStatus165 = true;
                }else{
                    if('165' == _this.formSetinfo.channel5){
                        _this.formSetinfo.channel5 = '0';
                    }
                    _this.channelsStatus165 = false;
                }
            },
            rebootmode:function () {
                var _this = this;
                _this.formSetinfo.rebootmode = _this.rebootmode;
            }
        },
        methods: {
            init: function() {
                var _this = this;
                var data = {};
                data.type = "exec";
                var postData = {"action":"scanAp","data":data};
                uiPost.scanAp(postData,function(data){
                    if (9999 == data.rescode){
                        cs.loginOut();
                    }

                    var wtime = 10;
                    _this.percent = 0;
                    var percentTimer = setInterval(function(){
                        if (_this.percent>=100) {
                            clearInterval(percentTimer);
                            var data = {};
                            data.type = "scan";
                            var postVar = {"action":"scanAp","data":data};
                            uiPost.scanAp(postVar,function(data){
                                if (9999 == data.rescode){
                                    cs.loginOut();
                                }
                                _this.centralData = data.data;
                                _this.apscanLoading = false;
                            });
                        }
                        _this.percent++;
                    },cs.getTimer(wtime));
                });
            },
            ok:function () {
                this.restoreClick();
            },
            cancel:function () {
                var _this = this;
                _this.showModel = false;
            },
            modifyApIp:function (data) {
                var _this = this;
                var postVar ={"action":"setApIp","data":data};
                uiPost.setApIp(postVar);
                var time = 12;
                _this.$Modal.success({
                    loading:true,
                    render: function(h) {
                        return h('div',[
                            _this.$t('common.loading'),
                            h('Progress',{
                                attrs:{ percent:_this.percent }
                            })
                        ])
                    }
                });
                var percentTimer = setInterval(function(){
                    if (_this.percent>=100) {
                        clearInterval(percentTimer);
                        location.href = location.href;
                    }
                    _this.percent++;
                },cs.getTimer(time));
            },
            apscanClick: function(){
                var _this = this;
                _this.apscanLoading = true;
                _this.init();
            },
            setinfoClick: function(){
                var _this = this;
                var temp = this.selectData;
                if (temp.length <= 0) {
                    this.$Message.error(this.$t('central.msg1'));
                    return false;
                }
                if (temp.length == 1) {
                    if(temp[0].apname){
                        this.formSetinfo.apname = temp[0].apname;
                    }else{
                        this.formSetinfo.apname = '';
                    }
                    _this.rebootmode = temp[0].schmode;
                    _this.formSetinfo.week = temp[0].schweek;
                    _this.formSetinfo.time[0] = Number(temp[0].schhour);
                    _this.formSetinfo.time[1] = Number(temp[0].schminute);
                    _this.formSetinfo.timedown = temp[0].rechour;

                    var data = {};
                    data.apid = temp[0].id;
                    var postVar = {"action" : "getApStatusConfig","data":data};

                    uiPost.getApStatusConfig(postVar,function(data){
                        if (9999 == data.rescode){
                            cs.loginOut();
                        }
                        if (0 == data.rescode) {
                            data = data.data;

                            if('1' == temp[0].aptype){
                                _this.wlanset    = '1';
                                _this.wlanState = true;
                            }else if('2' == temp[0].aptype){
                                _this.wlanset    = '2';
                                _this.wlanState = true;
                            }else{
                                _this.wlanset    = '1';
                                _this.wlanState = false;
                            }

                            if(data.WLAN_STATUS){
                                var apInfo = {};
                                _this.wlanStatus = data.WLAN_STATUS;
                                if('1' == _this.wlanset){
                                    apInfo = _this.wlanStatus['APS2G'];
                                }else{
                                    apInfo = _this.wlanStatus['APS5G'];
                                }

                                _this.formSetinfo.ssid    = apInfo.ssid;

                                if('0' == apInfo.encryption){
                                    _this.formSetinfo.securityMode = '0';
                                    _this.securityMode = false;
                                }else{
                                    _this.formSetinfo.securityMode = '1';
                                    _this.securityMode = true;
                                }
                                _this.formSetinfo.security    = apInfo.passphrase;
                                if('0' == apInfo.hide){
                                    _this.formSetinfo.hidessid = true;
                                }else{
                                    _this.formSetinfo.hidessid = false;
                                }
                                if('0' == apInfo.isolate){
                                    _this.formSetinfo.wifi_quarantine = false;
                                }else{
                                    _this.formSetinfo.wifi_quarantine = true;
                                }
                                _this.formSetinfo.maxusernumber    = apInfo.stanum;
                                _this.formSetinfo.vlanid    = apInfo.vlanid;
                            }

                            if(data.WIFI0_STATUS){
                                _this.formSetinfo.band2    = data.WIFI0_STATUS.wirelessmode;
                                _this.formSetinfo.country2g    = data.WIFI0_STATUS.country;
                                _this.formSetinfo.channel2    = data.WIFI0_STATUS.channel;
                                _this.formSetinfo.band_width2    = data.WIFI0_STATUS.htmode;
                                _this.formSetinfo.tx_power2    = data.WIFI0_STATUS.txpower;
                            }

                            if(data.WIFI1_STATUS){
                                _this.formSetinfo.band5    = data.WIFI1_STATUS.wirelessmode;
                                _this.formSetinfo.country5g    = data.WIFI1_STATUS.country;
                                _this.formSetinfo.channel5    = data.WIFI1_STATUS.channel;
                                _this.formSetinfo.band_width5    = data.WIFI1_STATUS.htmode;
                                _this.formSetinfo.tx_power5    = data.WIFI1_STATUS.txpower;
                            }
                        }

                    });

                    this.multipleHide = true;
                }else{
                    _this.wlanState = false;
                    _this.formSetinfo.apname    = '';
                    _this.formSetinfo.ssid    = '';
                    _this.formSetinfo.securityMode    = '0';
                    _this.securityMode = false;
                    _this.formSetinfo.security    = '';
                    _this.formSetinfo.hidessid    = true;
                    _this.formSetinfo.wifi_quarantine    = false;
                    _this.formSetinfo.maxusernumber    = '32';
                    _this.formSetinfo.vlanid    = '0';
                    _this.wlanset    = '1';

                    _this.formSetinfo.band2    = '9';
                    _this.formSetinfo.country2g    = 'CN';
                    _this.formSetinfo.channel2    = '0';
                    _this.formSetinfo.band_width2    = '0';
                    _this.formSetinfo.tx_power2    = '100';

                    _this.formSetinfo.band5    = '14';
                    _this.formSetinfo.country2g    = 'CN';
                    _this.formSetinfo.channel5    = '0';
                    _this.formSetinfo.band_width5    = '2';
                    _this.formSetinfo.tx_power5    = '100';

                    this.multipleHide = true;
                }
                this.setinfo = true;
            },
            centralTable: function(selection){
                this.selectData = selection;
            },
            setinfoOk: function(){
                var _this = this;
                var temp = this.selectData;


                var idArr = [];
                var data = {};
                for(var i in temp){
                    idArr[i] = temp[i].id
                }

                data.apid = idArr.join(',');
                data.apname = _this.formSetinfo.apname;

                if(_this.formSetinfo.rebootmode == '2') {
                    if (99 != cs.num(_this.formSetinfo.timedown)) {
                        _this.$Message.error({content: _this.$t('ac_central.msg27'), duration: 5});
                        return false;
                    }
                    if (99 != cs.num_range(_this.formSetinfo.timedown, 1, 240)) {
                        _this.$Message.error({content: _this.$t('ac_central.msg26'), duration: 5});
                        return false;
                    }
                }

                var res = cs.ssid(_this.formSetinfo.ssid);
                if(0 == res){
                    _this.$Message.error({content:_this.$t('central.msg10'),duration:5});
                    return false;
                }else if(99 != res){
                    _this.$Message.error({content:_this.$t('central.msg11'),duration:5});
                    return false;
                }

                var sch = {};
                sch.schMode = _this.formSetinfo.rebootmode;
                sch.schWeek = _this.formSetinfo.week;
                sch.schHour = String(_this.formSetinfo.time[0]);
                sch.schMinute = String(_this.formSetinfo.time[1]);
                sch.recHour = _this.formSetinfo.timedown;
                data.rebooSchedule = sch;

                data.ssid = _this.formSetinfo.ssid;
                data.encryption = _this.formSetinfo.securityMode;
                if('1' == _this.formSetinfo.securityMode){
                    var res = cs.string(_this.formSetinfo.security);
                    if(99 != res || _this.formSetinfo.security.length < 8 || _this.formSetinfo.security.length > 63){
                        _this.$Message.error({content:_this.$t('central.msg12'),duration:5});
                        return false;
                    }
                    data.wlanKey = _this.formSetinfo.security;
                }else{
                    data.wlanKey = '';
                }

                if(true == _this.formSetinfo.hidessid){
                    data.hedden = '0';
                }else{
                    data.hedden = '1';
                }
                if(true == _this.formSetinfo.wifi_quarantine){
                    data.noforward = '1';
                }else{
                    data.noforward = '0';
                }

                if(99 != cs.num_range(_this.formSetinfo.maxusernumber,0,64)){
                    _this.$Message.error({content:_this.$t('central.msg24'),duration:5});
                    return false;
                }
                data.maxstanum = _this.formSetinfo.maxusernumber;

                if(99 != cs.num(_this.formSetinfo.vlanid)){
                    _this.$Message.error({content:_this.$t('central.msg25'),duration:5});
                    return false;
                }
                if(99 != cs.num_range(_this.formSetinfo.vlanid,0,4094) ){
                    _this.$Message.error({content:_this.$t('central.msg14'),duration:5});
                    return false;
                }
                data.vlanid = _this.formSetinfo.vlanid;
                data.usefor = _this.wlanset;

                if('1' == _this.wlanset){
                    data.wirelessmode = _this.formSetinfo.band2;
                    data.country = _this.formSetinfo.country2g;
                    data.channel = _this.formSetinfo.channel2;
                    data.htbw = _this.formSetinfo.band_width2;
                    data.txpower = _this.formSetinfo.tx_power2;
                    data.beacon = _this.formSetinfo.beacon2g;
                }else{
                    data.wirelessmode = _this.formSetinfo.band5;
                    data.country = _this.formSetinfo.country5g;
                    data.channel = _this.formSetinfo.channel5;
                    data.htbw = _this.formSetinfo.band_width5;
                    data.txpower = _this.formSetinfo.tx_power5;
                    data.beacon = _this.formSetinfo.beacon5g;
                }

                var postData = { "action": "setQuick","data":data };

                uiPost.setQuick(postData,function(data){
                    if (9999 == data.rescode){
                        cs.loginOut();
                    }
                    if (0 == data.rescode) {
                        _this.$Message.success({
                            content: _this.$t('central.set_success'), onClose: function () {
                                location.href = location.href;
                            }
                        });
                    }else{
                        _this.$Message.error({content:_this.$t('central.set_fail')+_this.$t('errorcode.'+data.rescode),duration:5});
                    }
                });
            },
            letctlClick: function(){
                var temp = this.selectData;
                if (temp.length <= 0) {
                    this.$Message.error({content:_this.$t('central.msg1'),duration:5});
                    return false;
                }
                this.letctl = true;
            },
            letctlOk: function(index){
                var _this = this;
                var temp = this.selectData;

                if('2' == index){
                    _this.ledStatus = true;
                }else{
                    _this.ledStatus = false;
                }

                var idArr = [];
                var data = {};
                for(var i in temp){
                    idArr[i] = temp[i].id;
                }

                data.id = idArr.join(',');
                data.ledState = String(index);

                var postVar ={"action":"setApLedState","data":data};
                uiPost.setApLedState(postVar,function(data){
                    if (9999 == data.rescode){
                        cs.loginOut();
                    }
                    _this.letctl = false;
                    if (0 == data.rescode) {
                        _this.$Message.success({
                            content: _this.$t('central.set_success'), onClose: function () {
                                location.href = location.href;
                            }
                        });
                    }
                });
            },
            rebootClick: function(){
                var _this = this;
                var temp = this.selectData;
                if (temp.length <= 0) {
                    this.$Message.error(this.$t('central.msg1'));
                    return false;
                }

                var apid = [];
                var data = {};
                for(var i=0;i<temp.length;i++){
                    apid[i] = temp[i].id;
                }
                data.id = apid.join(',');

                var postVar ={"action":"setApReboot","data":data};
                uiPost.setApReboot(postVar,function(data){
                    if (9999 == data.rescode){
                        cs.loginOut();
                    }
                    // location.href = location.href;
                    if (0 == data.rescode) {
                        _this.$Message.success(_this.$t('central.set_success'));
                        _this.reboot = false;
                    }else{
                        _this.$Message.error({content:_this.$t('central.set_fail')+_this.$t('errorcode.'+data.rescode),duration:5});
                    }
                });


            },
            timingRebootClick: function(status){
                var _this = this;
                if (status) {
                    var getSelection = this.$refs.tableSelect.getSelection();
                    if (getSelection.length>0) {
                        /*全选*/
                        var tmpData = [];
                        var data = {};
                        for(var i=0; i<getSelection.length; i++){
                            if( ( getSelection[i].apstate!="511" ) & !(getSelection[i].apstate & (1<<8)) ) {
                                tmpData[i] = getSelection[i].apmac;
                            }
                        }
                        tmpData['apmac'] = tmpData.join(',');
                        if('' == tmpData['apmac'].length) {
                            _this.$Message.error({content:_this.$t('central.msg15'),duration:5});
                            return;
                        }
                        data.apmac = tmpData['apmac'];
                        var postVar ={"action":"setApIp","data":data};
                        _this.$Spin.show();  //加载动画
                        uiPost.setApIp(postVar,function (data) {
                            _this.$Spin.hide();   //关闭加载动画
                            if (9999 == data.rescode){
                                cs.loginOut();
                            }
                            location.href = location.href;
                        });

                    }else{
                        _this.$Message.error({content:_this.$t('central.msg16'),duration:5});
                    }
                }else{
                    _this.$refs.tableSelect.selectAll(status);
                }
            },
            timingRebootOk: function(){
                var _this = this;
                if (this.letctlAuthpwd == '') {
                    _this.$Message.error({content:_this.$t('central.msg2'),duration:5});
                    return false;
                }
                if (this.timingRebootSelect == '-1') {
                    _this.$Message.error({content:_this.$t('central.msg3'),duration:5});
                    return false;
                }

                var postVar ={"topicurl":"setting/QuickSetting"};
                var postData = {"Action" : "QuickSetting"};
                postData.AuthPassword = this.letctlAuthpwd;
                postData.SchdReboot = this.timingRebootSelect;


                postVar.Action = 'QuickSetting';

                postVar.APMACLIST = [];
                postVar.APIPLIST = [];
                postVar.NETLIST = [];
                var selectData = this.selectData;
                for(var i=0; i<selectData.length; i++)
                {
                    postVar.APMACLIST.push(selectData[i].apMac);
                    postVar.APIPLIST.push(selectData[i].ipaddr);
                    postVar.NETLIST.push(selectData[i].sameNetwork);
                }

                postVar.postData = postData;

                uiPost.QuickSetting(postVar,function(){
                    // location.href = location.href;
                    _this.$Message.success(_this.$t('central.set_success'));
                    _this.timingReboot = false;
                });
            },
            restoreClick: function(){
                var _this = this ;
                var temp = this.selectData;
                if (temp.length <= 0) {
                    _this.$Message.error({content:_this.$t('central.msg1'),duration:5});
                    return false;
                }
                var data = [];
                for(var i=0;i<temp.length;i++){
                    data[i] = temp[i].id;
                }

                var postVar ={"action":"setApRestore","data":data};
                uiPost.setApRestore(postVar,function(data){
                    if (9999 == data.rescode){
                        cs.loginOut();
                    }
                    if (0 == data.rescode) {
                        _this.$Message.success(_this.$t('central.set_success'));
                    }else{
                        _this.$Message.error({content:_this.$t('central.set_fail'),duration:5});
                    }
                    _this.reboot = false;
                });
            },
            restoreOk: function(){
                var _this = this;
                var postVar ={"topicurl":"setting/QuickSetting"};
                postVar.Action = 'LoadDefSettings';

                postVar.APMACLIST = [];
                postVar.APIPLIST = [];
                var selectData = this.selectData;
                for(var i=0; i<selectData.length; i++)
                {
                    postVar.APMACLIST.push(selectData[i].apMac);
                    postVar.APIPLIST.push(selectData[i].ipaddr);
                }

                uiPost.QuickSetting(postVar,function(){
                    // location.href = location.href;
                    _this.$Message.success(_this.$t('central.set_success'));
                    _this.restore = false;
                });
            },
            uploadClick: function(){
                var _this = this;
                var data =[];
                var centdata = _this.centralData;
                for(var i in centdata){
                    data[i] = centdata[i].csid;
                }
                var postData = {"action":"getApUpgradeInfo","data":data};
                _this.firmDataloading = true;
                uiPost.getApUpgradeInfo(postData,function(data){
                    if (9999 == data.rescode){
                        cs.loginOut();
                    }
                    _this.firmDataloading = false;
                    for (var j in data.data){
                        _this.firmData=data.data;
                    }
                });
                this.uploads = true;
            },
            firmwareClick: function(){
                var _this = this;
                var temp = this.selectData;
                if (temp.length <= 0) {
                    this.$Message.error(this.$t('central.msg1'));
                    return false;
                }
                this.firmware = true;

                var data = [];
                for(var i=0;i<temp.length;i++){
                    data[i] = temp[i].id;
                }

                var postVar ={"action":"setApUpgrade","data":data};
                uiPost.setApUpgrade(postVar,function(data){
                    // location.href = location.href;
                    if (9999 == data.rescode){
                        cs.loginOut();
                    }
                    _this.$Message.success(_this.$t('central.set_success'));
                    _this.firmware = false;
                });
            },
            firmwareOk: function(){
                if (this.letctlAuthpwd == '') {
                    this.$Message.error(this.$t('central.msg2'));
                    return false;
                }
            },
            firmwareOk1:function(){
                var _this = this;
                var postVar ={"topicurl":"setting/QuickSetting"};
                postVar.AuthPassword = this.letctlAuthpwd;
                postVar.Action = 'RemoteUpgradeFW';
                postVar.Port = '80';
                postVar.ProxyEnabled = '0';

                postVar.APMACLIST = [];
                postVar.APIPLIST = [];
                postVar.URLLIST = [];
                postVar.MD5LIST = [];
                var selectData = this.selectData;
                for(var i=0; i<selectData.length; i++)
                {
                    postVar.APMACLIST.push(selectData[i].apMac);
                    postVar.APIPLIST.push(selectData[i].ipaddr);
                    postVar.URLLIST.push(selectData[i].fwUrl);
                    postVar.MD5LIST.push(selectData[i].fwMd5);
                }

                uiPost.QuickSetting(postVar,function(){
                    // location.href = location.href;
                    _this.firmware = false;
                });
            },
            handleUpload: function(file) {
                this.upload.file = file;
            },
            formatError: function() {
                this.$Message.error({content:this.$t('central.msg19',[this.upload.format.join('、')]),duration: 5});
            },
            uploadSuccess:function(){
                this.$Message.success({content:this.$t('central.upload_success'),onClose:function(){
                    location.href = location.href;
                }});
            },
		    handleBeforeUpload:function(file) {
                var _this = this;
                var filename=file.name;
                var name1 = filename.split("_");
                var csid = name1[1];
                var apdata = _this.centralData;
                if(apdata.length == 0){
                    this.$Message.error({content:this.$t('central.msg17')});
                    return false;
                }
                var k = 0;
                for(var i in apdata){
                    if(apdata[i].csid.includes(csid) || csid.includes(apdata[i].csid)){
                        k = 1;
                        break;
                    }
                }
                if(k == 0){
                    this.$Message.error({content:this.$t('central.msg17')});
                    return false;
                }else {
                    return true;
                }
            },
            remove:function (index) {
                this.firmData.splice(index, 1);
            }
        }
    };
</script>
<script src="/newui/static/js/main.js"></script>
</body>
</html>